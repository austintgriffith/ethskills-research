# x402: HTTP Payment Protocol for AI Agents

## Overview
**x402** is an open standard for internet-native payments, built directly into HTTP. By leveraging the long-dormant **HTTP 402 "Payment Required"** status code, x402 enables AI agents and humans to pay for digital services with cryptocurrency **without additional API keys, accounts, or external payment flows**.

**Official Website**: https://www.x402.org  
**Created by**: Coinbase (open standard)  
**Repository**: https://github.com/coinbase/x402

## Core Innovation
x402 makes payments a **first-class citizen of HTTP**, not a bolt-on afterthought. This enables:
- **Frictionless agent-to-agent commerce** (AI agents paying other agents)
- **Pay-per-use APIs** without subscriptions or invoicing
- **Micropayments** (sub-$0.0001 transaction fees on L2s)
- **No pre-funding** or account creation required

## How x402 Works

### Standard HTTP Flow
```
1. Client ‚Üí GET /weather HTTP/1.1
2. Server ‚Üí 402 Payment Required
   Headers:
     PAYMENT-REQUIRED: <base64-encoded payment requirements>

3. Client constructs payment, signs transaction
4. Client ‚Üí GET /weather HTTP/1.1
   Headers:
     PAYMENT-SIGNATURE: <base64-encoded payment payload>

5. Server verifies payment (locally or via facilitator)
6. Server executes/settles payment
7. Server ‚Üí 200 OK
   Headers:
     PAYMENT-RESPONSE: <base64-encoded settlement response>
   Body: <requested resource>
```

### Key Components

#### 1. Resource Server
The HTTP server providing an API or resource (data, compute, AI inference, etc.)

#### 2. Client
An entity (human or agent) wanting to pay for a resource

#### 3. Facilitator (optional)
A server that facilitates verification and execution of payments for one or many networks. Handles:
- Payment verification
- Transaction submission to blockchain
- Gas management
- Confirmation tracking

**Facilitator Endpoints:**
- `POST /verify` - Verifies payment payload without executing
- `POST /settle` - Executes payment on blockchain and waits for confirmation

#### 4. Payment Payload Structure
```json
{
  "scheme": "exact",           // Payment scheme (exact, upto, etc.)
  "network": "eip155:8453",    // Chain identifier (Base in this example)
  "amount": "1000000",         // Amount in token smallest unit
  "token": "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913", // USDC
  "from": "0x...",             // Payer address
  "to": "0x...",               // Payee address
  "signature": "0x...",        // Transaction signature
  "deadline": 1234567890,      // Expiry timestamp
  "nonce": "unique-value"      // Replay protection
}
```

## Supported Networks
x402 is **network-agnostic** and supports:
- **EVM chains**: Ethereum, Base, Arbitrum, Optimism, Polygon, etc.
- **Solana** (SVM)
- **Future**: Bitcoin Lightning, Stellar, other crypto rails
- **Extensible** to fiat networks (while never deprioritizing crypto)

## Payment Schemes

### 1. **exact** (currently implemented)
Transfer a specific, predetermined amount.
- **Use case**: Pay $1 to read an article, $0.01 per API call
- **Execution**: Resource server knows exact price upfront

### 2. **upto** (proposed)
Transfer up to a maximum amount, based on resource consumption.
- **Use case**: LLM token generation (pay per token), GPU compute time
- **Execution**: Final amount determined after request completes

Each scheme has network-specific implementations:
- `exact` on EVM: EIP-712 signed permit or EIP-3009 `transferWithAuthorization`
- `exact` on Solana: Solana transaction signatures

## SDK Support

### TypeScript/JavaScript
```bash
# Full SDK
npm install @x402/core @x402/evm @x402/svm @x402/express @x402/next

# Minimal Client
npm install @x402/core @x402/evm @x402/fetch

# Minimal Server
npm install @x402/core @x402/evm @x402/express
```

**Express Server Example:**
```typescript
import { paymentMiddleware } from '@x402/express';

app.use(
  paymentMiddleware({
    "GET /weather": {
      accepts: [
        { network: "eip155:8453", token: "USDC", amount: "100000" } // $0.10
      ],
      description: "Current weather data",
    },
  })
);

// That's it! Middleware handles payment flow automatically
```

**Fetch Client Example:**
```typescript
import { x402Fetch } from '@x402/fetch';

const response = await x402Fetch('https://api.example.com/weather', {
  wallet: myWallet,
  preferredNetwork: 'eip155:8453', // Base
});
```

### Python
```bash
pip install x402
```

### Go
```bash
go get github.com/coinbase/x402/go
```

## Integration with x402

### Server-Side (1-Line Integration)
```typescript
// Express.js
app.use(paymentMiddleware(paymentConfig));

// Hono
app.use(x402Middleware(paymentConfig));

// Next.js
export const config = { x402: paymentRequirements };
```

### Client-Side
```typescript
// Axios
import { x402Axios } from '@x402/axios';
const client = x402Axios.create({ wallet });

// Native Fetch
import { x402Fetch } from '@x402/fetch';
const data = await x402Fetch(url, { wallet });
```

## Key Principles (from x402 Spec)

### 1. Open Standard
Freely accessible, no single party gatekeeping. MIT/Apache-licensed SDKs.

### 2. HTTP/Transport Native
No additional roundtrips outside normal client-server flow. Payment negotiation happens via standard HTTP headers.

### 3. Network, Token, Currency Agnostic
Supports any blockchain, any token, any payment scheme (including future fiat rails).

### 4. Backwards Compatible
Won't deprecate support for existing networks unless security-critical.

### 5. Trust Minimizing
Facilitators and resource servers **cannot move funds** beyond client intentions. Cryptographic guarantees.

### 6. Easy to Use
10x better than existing payment flows. Abstract away gas, RPC endpoints, nonce management‚Äîclients and servers shouldn't think about blockchain internals.

## Use Cases

### 1. AI Agent Payments
- AI agent pays another agent for data, compute, or specialized inference
- No invoicing, reconciliation, or batching
- Instant settlement with proof

### 2. Pay-Per-Use APIs
- Weather data, financial market data, geolocation services
- Eliminates subscription overhead for low-volume users
- Enables long-tail API monetization

### 3. Metered Compute
- GPU time billed per second
- Database queries billed per request
- Storage billed per GB-month

### 4. Content Paywalls
- Articles, videos, research papers
- Micropayments without credit card friction

### 5. Autonomous Agent Commerce
Combined with **ERC-8004** (agent identity), x402 enables:
- Agent discovers another agent's capabilities
- Negotiates price via x402 payment requirements
- Pays and receives service‚Äîall autonomous

## Ecosystem Projects (x402.org/ecosystem)

### Services & Endpoints
- **SLAMai**: Smart money intelligence platform on Base & Ethereum
- **QuickNode**: RPC endpoints with x402 payment support
- **OnFinality**: Multi-chain API access

### Infrastructure
- **Payment gateways** accepting USDC on Base
- **Facilitator services** handling blockchain complexity
- **Agent orchestrators** with built-in x402 support

### Development Tools
- **x402 Paywall Starter**: Template for building paywalled services
- **Extensions**: Browser extensions for seamless payments
- **Demo apps**: Reference implementations

## Technical Deep-Dive

### Payment Verification Flow
1. **Client signs transaction** (EIP-712 for EVM, native for Solana)
2. **Server receives PAYMENT-SIGNATURE header**
3. **Server calls facilitator `/verify`** (optional, can verify locally)
4. **Facilitator checks**:
   - Signature validity
   - Token allowance/balance
   - Deadline not expired
   - Nonce not reused
5. **Returns verification response** (valid/invalid + reason)

### Payment Settlement Flow
1. **Server executes work** (after verification passes)
2. **Server calls facilitator `/settle`**
3. **Facilitator**:
   - Submits transaction to blockchain
   - Manages gas (can sponsor or forward)
   - Waits for confirmation
4. **Returns settlement response** with transaction hash
5. **Server includes PAYMENT-RESPONSE header** in 200 OK response

### Security Guarantees
- **Signature verification**: EIP-712 typed data signatures prevent tampering
- **Deadline expiry**: Prevents replay attacks over time
- **Nonce tracking**: Prevents double-spending of same signature
- **Amount verification**: Client signs exact amount, server/facilitator enforces
- **Token whitelisting**: Servers specify accepted tokens (typically stablecoins)

## Comparison with Traditional Payments

| Feature | x402 | Credit Cards | Web3 Wallets (Manual) |
|---------|------|--------------|------------------------|
| Transaction fees | <$0.001 (L2) | 2.9% + $0.30 | $0.50-$5 (L1) |
| Account required | ‚ùå No | ‚úÖ Yes | ‚úÖ Yes (wallet) |
| Invoicing delay | ‚ö° Instant | üìÖ Net-30 | ‚ö° Instant |
| Micropayments | ‚úÖ Yes | ‚ùå No (minimums) | ‚ö†Ô∏è Expensive |
| Agent-friendly | ‚úÖ Yes | ‚ùå No | ‚ö†Ô∏è Manual |
| API key management | ‚ùå None | N/A | ‚ùå None |
| Chargeback risk | ‚ùå None | ‚úÖ Yes | ‚ùå None |

## x402 + ERC-8004 Synergy

The combination is **powerful**:
1. **Agent discovers service** via ERC-8004 identity registry
2. **Agent checks reputation** via ERC-8004 reputation registry
3. **Agent calls endpoint** (HTTP GET)
4. **Receives 402 Payment Required** with x402 headers
5. **Agent signs payment** and retries request
6. **Server verifies + settles** via x402 flow
7. **Agent receives service**, posts feedback to ERC-8004

This enables **fully autonomous agent economies** with trust and payments built-in.

## Roadmap (from GitHub)

### Near-term
- [ ] Additional scheme support (`upto`, `streaming`)
- [ ] More network integrations (Cosmos, Aptos, Sui)
- [ ] Facilitator reference implementations
- [ ] Browser extension for seamless human payments

### Long-term
- [ ] Fiat on/off-ramps (stablecoin ‚Üî fiat)
- [ ] Multi-signature payment schemes
- [ ] Subscription-style recurring payments
- [ ] Conditional payment releases (escrow)

## Real-World Adoption (Early 2026)

### Production Deployments
- **Database APIs** charging per query (USDC on Base)
- **AI inference endpoints** metered by tokens generated
- **Weather/geolocation data** pay-per-request
- **Agent communication** between autonomous systems

### Metrics (Anecdotal from x402.org)
- **Transaction volume**: Growing rapidly in Q1 2026
- **Average payment**: $0.05-$0.50 (micropayments dominating)
- **Networks**: 80%+ on Base (low fees), 15% Arbitrum, 5% Ethereum mainnet
- **Tokens**: 95%+ USDC (stablecoin preferred for pricing)

## Developer Quick-Start

### 1. Server Setup (Express)
```typescript
import express from 'express';
import { paymentMiddleware } from '@x402/express';

const app = express();

app.use(paymentMiddleware({
  "GET /api/data": {
    accepts: [
      { network: "eip155:8453", token: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913", amount: "100000" }
    ],
    description: "Premium data access"
  }
}));

app.get('/api/data', (req, res) => {
  // Payment verified automatically by middleware
  res.json({ data: "Premium content" });
});

app.listen(3000);
```

### 2. Client Setup (Fetch)
```typescript
import { x402Fetch } from '@x402/fetch';
import { createWallet } from '@x402/evm';

const wallet = createWallet(privateKey);

const response = await x402Fetch('https://api.example.com/api/data', {
  wallet,
  preferredNetwork: 'eip155:8453' // Base
});

const data = await response.json();
```

### 3. Testing Locally
```bash
# Clone examples
git clone https://github.com/coinbase/x402
cd x402/typescript/examples/express-basic

# Install
npm install

# Run server
npm start

# Run client (in separate terminal)
node client.js
```

## Best Practices

### For Service Providers
1. **Accept stablecoins** (USDC/USDT) for price stability
2. **Deploy on L2s** (Base, Arbitrum) for low transaction fees
3. **Use facilitators** to abstract blockchain complexity
4. **Set reasonable deadlines** (5-10 minutes for payment expiry)
5. **Log payment proofs** for accounting/auditing

### For Clients/Agents
1. **Maintain balance** on preferred network (pre-fund with stablecoins)
2. **Approve tokens** once for resource server address
3. **Handle 402 responses** gracefully (retry with payment)
4. **Cache payment requirements** to reduce roundtrips
5. **Monitor gas prices** and switch networks if needed

## Standards Compatibility

### Required
- **EIP-712**: Typed structured data signing (EVM)
- **EIP-3009**: `transferWithAuthorization` for gasless transfers

### Recommended
- **EIP-2612**: `permit` function (alternative to EIP-3009)
- **ERC-20**: Standard token interface

### Integrates With
- **ERC-8004**: Agent identity and reputation
- **EIP-7702**: Smart accounts (future EOA delegation)
- **EIP-4337**: Account abstraction

## Alternatives & Comparisons

| Protocol | Focus | Payment Method | Agent Support |
|----------|-------|----------------|---------------|
| **x402** | HTTP-native payments | On-chain crypto | ‚úÖ First-class |
| **Stripe** | Traditional web | Credit cards | ‚ùå None |
| **Lightning** | Bitcoin payments | Off-chain channels | ‚ö†Ô∏è Limited |
| **Connext** | Cross-chain transfers | State channels | ‚ö†Ô∏è Complex |
| **Request Network** | Invoice protocol | On-chain invoices | ‚ö†Ô∏è Manual |

## Resources & Links

- **Official Site**: https://www.x402.org
- **GitHub Repo**: https://github.com/coinbase/x402
- **Specification PDF**: https://www.x402.org/x402.pdf
- **Ecosystem Page**: https://www.x402.org/ecosystem
- **QuickNode Guide**: https://www.quicknode.com/guides/infrastructure/how-to-use-x402-payment-required

## Contributing
x402 is an **open standard**. Contributions welcome:
- New network integrations (submit PRs)
- Payment scheme proposals (open issues)
- SDK implementations (any language)
- Example applications (showcase page)

**Contribution Guidelines**: https://github.com/coinbase/x402/blob/main/CONTRIBUTING.md

---

**Last Updated**: February 2026  
**Current Status**: Production-ready, actively deployed  
**Maintainer**: Coinbase (with open community governance)
